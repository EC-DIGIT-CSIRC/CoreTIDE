title: MDR Schema validator
description: A Managed Detection Rule is ...

$schema: http://json-schema.org/draft-07/schema#
additionalProperties: false

tide.placeholders:
  SCHEMA_VERSION: mdr::2.0

required:
  - name
  - response
  - description
  - configurations

tide.template.force-required:
  - metadata
  - schema
  - uuid

anyOf:
  - required:
    - metadata
  - required:
    - meta

properties:

  name:
    title: Display name
    type: string
    description: Verbose, human readable name for the detection rule
    example: New Abnormal Credentials added to Azure AD

  uuid:
    title: LEGACY UUID - DO NOT USE
    type: string
    description: Legacy location for UUID used for backward compatibility. For all new object, use new location under metadata.
    pattern: ^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$
    tide.meta.deprecation: Use UUID under metadata instead
    tide.template.hide: True

  references:
    tide.meta.definition: true

  metadata:
    tide.template.spacer: true
    tide.meta.definition: true

  meta:
    tide.template.hide: true
    tide.meta.deprecation: Use metadata keyword instead
    tide.meta.definition: metadata

  description:
    title: Detection description
    tide.template.spacer: true
    description: Explanation of what the detection rule is detecting, in order to give context to alerts receivers.
    type: string
    tide.template.multiline : True

  detection_model: 
    title: CoreTIDE Cyber Detection Model
    tide.vocab: cdm
    description: CDM that this detection rule is implementing.
    example: CDM0016

  response:
    title: Incident Response Details
    type: object
    description: Information regarding incident response procedures
    required:
      - alert_severity
    properties:

      alert_severity: 
        title: Alert Severity
        type: string
        description: Describes the level of attention required to handle the alert generated by the MDR.
        tide.vocab: true

      playbook: 
        title: Playbook link
        type: string
        format: uri
        description: Link to the playbook on Confluence
        example: https://internal-knowledge-base/playbook/account_brute_force
      
      responders:
        title: Alert Handling Team
        type: string
        tide.vocab: true
        description: Team responsible for handling related incoming alerts

  configurations:
    title: Detection System Technical Setup
    type: object
    description: Per system setup of the detection configurations
    recomposition : systems # Calls the automation to insert subschemas
