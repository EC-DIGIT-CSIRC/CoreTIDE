title: MDR Schema validator
description: A Managed Detection Rule is ...

$schema: http://json-schema.org/draft-07/schema#
additionalProperties: false


required:
  - name
  - uuid
  - response
  - description
  - configurations

properties:

  name:
    title: Display name
    type: string
    description: Verbose, human readable name for the detection rule
    example: New Abnormal Credentials added to Azure AD

  uuid: 
    title: Unique identifier for the use-case
    type: string
    format: uuid
    description: This an UUID Gen 4 (you can use https://www.uuidgenerator.net/version4 to generate UUIDs) or ALT+SHIFT+U under Visual Studio Code
    example: 323d548d-17ca-46fa-a7c7-de43302456a1

  references:
    tide.meta.definition: true

  meta:
    tide.template.hide: true
    tide.meta.deprecation: Use metadata keyword instead
    tide.meta.definition: metadata

  metadata:
    tide.template.spacer: true
    tide.meta.definition: true

  description:
    title: Detection description
    tide.template.spacer: true
    description: Explanation of what the detection rule is detecting, in order to give context to alerts receivers.
    type: string
    tide.template.multiline : True

  detection_model: 
    title: TIDeMEC Cyber Detection Model
    type: string
    tide.vocab: true
    description: CDM that this detection rule is implementing.
    example: CDM0016

  response:
    title: Incident Response Details
    type: object
    description: Information regarding incident response procedures
    required:
      - alert_severity
    properties:

      alert_severity: 
        title: Alert Severity
        type: string
        description: Describes the level of attention required to handle the alert generated by the MDR.
        tide.vocab: true

      playbook: 
        title: Playbook link
        type: string
        format: uri
        description: Link to the playbook on Confluence
        example: https://internal-knowledge-base/playbook/account_brute_force
      
      responders:
        title: Alert Handling Team
        type: string
        tide.vocab: true
        description: Team responsible for handling related incoming alerts

  configurations:
    title: Detection System Technical Setup
    type: object
    description: Per system setup of the detection configurations
    recomposition : systems # Calls the automation to insert subschemas